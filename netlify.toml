[build]
  publish = "frontend/dist"
  command = "npm install && cd frontend && npm install && npm run build"

[functions]
  directory = "netlify/functions"
  node_bundler = "esbuild"

[build.environment]
  NODE_VERSION = "20"
  VITE_API_BASE = "/.netlify/functions"

# Endpoints expl√≠citos
[[redirects]]
  from = "/api/diag"
  to   = "/.netlify/functions/diag"
  status = 200

[[redirects]]
  from = "/api/health"
  to   = "/.netlify/functions/health"
  status = 200

[[redirects]]
  from = "/api/deals/import"
  to   = "/.netlify/functions/deals-import"
  status = 200

# Fallback general por si se usa /api/* antiguo
[[redirects]]
  from = "/api/*"
  to   = "/.netlify/functions/:splat"
  status = 200

# SPA fallback
[[redirects]]
  from = "/*"
  to   = "/index.html"
  status = 200
